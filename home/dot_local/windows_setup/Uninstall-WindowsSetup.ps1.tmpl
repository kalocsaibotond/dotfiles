."..\..\Documents\PowerShell\Functions.ps1"

# Cleaning up configuration

Remove-ContextMenuDir -DisplayName "WezTerm"
reg import "$(scoop prefix pwsh)\uninstall-explorer-context.reg"  # needs double run
reg import "$(scoop prefix pwsh)\uninstall-file-context.reg"

$Targets = @(chezmoi managed --include files --path-style absolute)
foreach ($Target in $Targets) {
    Remove-Item -Path $Target
}
chezmoi purge

# Cleaning up installations
# NOTE: Only Scoop, Git, and Winget remains

winget uninstall `
    {{range .winget.packages}}{{.}} `
    {{end -}}
    --purge `
    --accept-source-agreements `
    --accept-package-agreements `
    --silent `
    --disable-interactivity

scoop uninstall `
    {{range .scoop.packages}}{{.}} `
    {{end -}}
    --purge

